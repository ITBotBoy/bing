{"ast":null,"code":"const moment = require('moment');\n\nexport default ((req, res) => {\n  let {\n    date = 0,\n    count = 0\n  } = req.query,\n      monthData;\n  const {\n    imgArr\n  } = global; //  28\n\n  /*if(Number(date)){\n      console.log(date)\n      date=String(date).slice(0,6)\n      monthData=imgArr.filter(i=>String(i.date).includes(date))\n      //今天距离月初的天数\n      // count=new Date(date.slice(4), date.slice(2), 0).getDate()\n  }else {\n      const now = moment().format('YYYYMM');\n      monthData=imgArr.filter(i=>String(i.date).includes(now))\n      if(monthData.length<28){\n          const last=moment().subtract(1, 'month').format('YYYYMM')\n          const lastMonthData=imgArr.filter(i=>String(i.date).includes(last))\n          console.log(imgArr.length,'lastMonthData')\n          monthData=monthData.concat(lastMonthData)\n      }\n  }*/\n\n  let startIndex = imgArr.findIndex(({\n    date: d\n  }) => date === `${d}`);\n  startIndex < 0 && (startIndex = imgArr.length - 1);\n  res.json({\n    data: [...imgArr.slice(Math.max(0, startIndex - (count - 1)), startIndex + 1)].reverse()\n  });\n});","map":null,"metadata":{},"sourceType":"module"}