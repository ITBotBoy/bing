{"ast":null,"code":"import { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar _s = $RefreshSig$();\n\nimport { useEffect, useState, useRef } from 'react';\nimport { Modal, Radio, Spin, Select, Button, message } from 'antd';\nimport \"../styles/downDialog.scss\";\nimport download from \"../util/download\";\nimport axios from \"axios\";\nimport throttle from 'lodash/throttle';\nvar Option = Select.Option;\n\nvar DownDialog = function DownDialog(_ref) {\n  _s();\n\n  var isMobile = _ref.isMobile,\n      visible = _ref.visible,\n      imgInfo = _ref.imgInfo,\n      onHide = _ref.onHide,\n      downloadFun = _ref.downloadFun;\n\n  var _useState = useState('1920x1080'),\n      size = _useState[0],\n      setSize = _useState[1];\n\n  var _useState2 = useState(true),\n      imgLoading = _useState2[0],\n      setImgLoading = _useState2[1];\n\n  var downLink = useRef();\n  var sizeMap = [['1920x1200', '1920x1080', '1366x768', '1280x768', '1024x768'], ['800x600', '800x480', '768x1280', '720x1280', '640x480', '480x800', '400x240', '320x240', '240x320']];\n\n  var updateSize = function updateSize(val) {\n    window.localStorage.setItem('bing_down_size', val);\n    setImgLoading(true);\n    setSize(val);\n  };\n\n  var onClickDown = function onClickDown() {\n    var urlbase = imgInfo.urlbase,\n        date = imgInfo.date;\n    download(\"//cn.bing.com\".concat(urlbase, \"_\").concat(size, \".jpg\"), \"bing_\".concat(date, \"_\").concat(size, \".jpg\"));\n    downloadFun(date);\n    message.info('加入下载！');\n  };\n\n  var throttleOnClickDown = throttle(function () {\n    return onClickDown();\n  }, 3000);\n  useEffect(function () {\n    var size = window.localStorage.getItem('bing_down_size') || '1920x1080';\n\n    if (isMobile) {\n      size = '768x1280';\n    }\n\n    setSize(size);\n  }, [isMobile]);\n  var downImg = useRef();\n  useEffect(function () {\n    if (downImg && downImg.current && downImg.current.complete) {\n      setImgLoading(false);\n    }\n  }, [imgInfo]);\n  return /*#__PURE__*/_jsx(Modal, {\n    visible: visible,\n    onClose: onHide,\n    onCancel: onHide,\n    footer: null,\n    wrapClassName: \"down-dialog mode-\".concat(isMobile && 'mobile'),\n    children: /*#__PURE__*/_jsxs(\"div\", {\n      className: \"down-dialog-content\",\n      children: [imgInfo && /*#__PURE__*/_jsxs(\"div\", {\n        children: [/*#__PURE__*/_jsx(Spin, {\n          spinning: imgLoading,\n          children: /*#__PURE__*/_jsx(\"img\", {\n            ref: downImg,\n            onLoad: function onLoad() {\n              return setImgLoading(false);\n            },\n            className: \"down-img\",\n            src: \"//cn.bing.com\".concat(imgInfo.urlbase, \"_\").concat(size, \".jpg\")\n          })\n        }), isMobile ? /*#__PURE__*/_jsx(\"div\", {\n          className: \"select-size-container\",\n          children: /*#__PURE__*/_jsx(Select, {\n            value: size,\n            onChange: function onChange(v) {\n              return updateSize(v);\n            },\n            children: sizeMap.map(function (arr, i) {\n              return arr.map(function (size) {\n                return /*#__PURE__*/_jsx(Option, {\n                  value: size,\n                  children: size\n                }, \"size-\".concat(size));\n              });\n            })\n          })\n        }) : /*#__PURE__*/_jsx(\"div\", {\n          className: \"select-size-container\",\n          children: sizeMap.map(function (arr, i) {\n            return /*#__PURE__*/_jsxs(\"div\", {\n              className: \"size-row\",\n              children: [/*#__PURE__*/_jsx(\"i\", {\n                className: \"iconfont type-icon icon-\".concat(['pc', 'mobile'][i], \" \").concat(arr.indexOf(size) > -1 && 'actived')\n              }), /*#__PURE__*/_jsx(Radio.Group, {\n                value: size,\n                onChange: function onChange(e) {\n                  return updateSize(e.target.value);\n                },\n                children: arr.map(function (size) {\n                  return /*#__PURE__*/_jsx(Radio.Button, {\n                    value: size,\n                    children: size\n                  }, \"\".concat(i, \"-\").concat(size));\n                })\n              })]\n            }, \"size-type-\".concat(i));\n          })\n        }), /*#__PURE__*/_jsxs(Button, {\n          type: \"primary\",\n          className: \"down-icon\",\n          onClick: function onClick() {\n            return throttleOnClickDown();\n          },\n          children: [/*#__PURE__*/_jsx(\"i\", {\n            className: \"iconfont icon-download\"\n          }), isMobile ? '' : '下载']\n        })]\n      }), /*#__PURE__*/_jsx(\"a\", {\n        ref: downLink,\n        href: \"//cn.bing.com\".concat(imgInfo.urlbase, \"_\").concat(size, \".jpg\"),\n        download: \"bing_\".concat(imgInfo.date, \"_\").concat(size, \".jpg\")\n      })]\n    })\n  });\n};\n\n_s(DownDialog, \"YHXKE45uf546cvd3ATUaXt+qZhM=\");\n\n_c = DownDialog;\nexport default DownDialog;\n\nvar _c;\n\n$RefreshReg$(_c, \"DownDialog\");","map":{"version":3,"sources":["E:/Future/bing/components/downDialog.js"],"names":["useEffect","useState","useRef","Modal","Radio","Spin","Select","Button","message","download","axios","throttle","Option","DownDialog","isMobile","visible","imgInfo","onHide","downloadFun","size","setSize","imgLoading","setImgLoading","downLink","sizeMap","updateSize","val","window","localStorage","setItem","onClickDown","urlbase","date","info","throttleOnClickDown","getItem","downImg","current","complete","v","map","arr","i","indexOf","e","target","value"],"mappings":";;;;;AAAA,SAAQA,SAAR,EAAmBC,QAAnB,EAA6BC,MAA7B,QAA0C,OAA1C;AACA,SAAQC,KAAR,EAAeC,KAAf,EAAsBC,IAAtB,EAA4BC,MAA5B,EAAoCC,MAApC,EAA4CC,OAA5C,QAA0D,MAA1D;AACA,OAAO,2BAAP;AACA,OAAOC,QAAP,MAAqB,kBAArB;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,iBAArB;IACOC,M,GAAUN,M,CAAVM,M;;AAEP,IAAMC,UAAU,GAAG,SAAbA,UAAa,OAAsD;AAAA;;AAAA,MAApDC,QAAoD,QAApDA,QAAoD;AAAA,MAA1CC,OAA0C,QAA1CA,OAA0C;AAAA,MAAjCC,OAAiC,QAAjCA,OAAiC;AAAA,MAAxBC,MAAwB,QAAxBA,MAAwB;AAAA,MAAjBC,WAAiB,QAAjBA,WAAiB;;AAAA,kBAC7CjB,QAAQ,CAAC,WAAD,CADqC;AAAA,MAC9DkB,IAD8D;AAAA,MACxDC,OADwD;;AAAA,mBAEjCnB,QAAQ,CAAC,IAAD,CAFyB;AAAA,MAE9DoB,UAF8D;AAAA,MAElDC,aAFkD;;AAGrE,MAAMC,QAAQ,GAAGrB,MAAM,EAAvB;AAEA,MAAMsB,OAAO,GAAG,CACZ,CACI,WADJ,EAEI,WAFJ,EAGI,UAHJ,EAII,UAJJ,EAKI,UALJ,CADY,EAQZ,CACI,SADJ,EAEI,SAFJ,EAGI,UAHJ,EAII,UAJJ,EAKI,SALJ,EAMI,SANJ,EAOI,SAPJ,EAQI,SARJ,EASI,SATJ,CARY,CAAhB;;AAqBA,MAAMC,UAAU,GAAG,SAAbA,UAAa,CAACC,GAAD,EAAS;AACxBC,IAAAA,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,gBAA5B,EAA8CH,GAA9C;AACAJ,IAAAA,aAAa,CAAC,IAAD,CAAb;AACAF,IAAAA,OAAO,CAACM,GAAD,CAAP;AACH,GAJD;;AAMA,MAAMI,WAAW,GAAG,SAAdA,WAAc,GAAM;AAAA,QACfC,OADe,GACEf,OADF,CACfe,OADe;AAAA,QACNC,IADM,GACEhB,OADF,CACNgB,IADM;AAEtBvB,IAAAA,QAAQ,wBAAiBsB,OAAjB,cAA4BZ,IAA5B,0BAAgDa,IAAhD,cAAwDb,IAAxD,UAAR;AACAD,IAAAA,WAAW,CAACc,IAAD,CAAX;AACAxB,IAAAA,OAAO,CAACyB,IAAR,CAAa,OAAb;AACH,GALD;;AAMA,MAAMC,mBAAmB,GAAGvB,QAAQ,CAAC;AAAA,WAAImB,WAAW,EAAf;AAAA,GAAD,EAAmB,IAAnB,CAApC;AACA9B,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAImB,IAAI,GAAGQ,MAAM,CAACC,YAAP,CAAoBO,OAApB,CAA4B,gBAA5B,KAAiD,WAA5D;;AACA,QAAIrB,QAAJ,EAAc;AACVK,MAAAA,IAAI,GAAG,UAAP;AACH;;AACDC,IAAAA,OAAO,CAACD,IAAD,CAAP;AACH,GANQ,EAMN,CAACL,QAAD,CANM,CAAT;AAQA,MAAMsB,OAAO,GAAGlC,MAAM,EAAtB;AACAF,EAAAA,SAAS,CAAC,YAAM;AACZ,QAAIoC,OAAO,IAAIA,OAAO,CAACC,OAAnB,IAA8BD,OAAO,CAACC,OAAR,CAAgBC,QAAlD,EAA4D;AACxDhB,MAAAA,aAAa,CAAC,KAAD,CAAb;AACH;AACJ,GAJQ,EAIN,CAACN,OAAD,CAJM,CAAT;AAMA,sBACI,KAAC,KAAD;AACI,IAAA,OAAO,EAAED,OADb;AAEI,IAAA,OAAO,EAAEE,MAFb;AAGI,IAAA,QAAQ,EAAEA,MAHd;AAII,IAAA,MAAM,EAAE,IAJZ;AAKI,IAAA,aAAa,6BAAsBH,QAAQ,IAAI,QAAlC,CALjB;AAAA,2BAOI;AAAK,MAAA,SAAS,EAAC,qBAAf;AAAA,iBACKE,OAAO,iBACJ;AAAA,gCACI,KAAC,IAAD;AAAM,UAAA,QAAQ,EAAEK,UAAhB;AAAA,iCACI;AACI,YAAA,GAAG,EAAEe,OADT;AAEI,YAAA,MAAM,EAAE;AAAA,qBAAMd,aAAa,CAAC,KAAD,CAAnB;AAAA,aAFZ;AAGI,YAAA,SAAS,EAAC,UAHd;AAII,YAAA,GAAG,yBAAkBN,OAAO,CAACe,OAA1B,cAAqCZ,IAArC;AAJP;AADJ,UADJ,EAWQL,QAAQ,gBACJ;AAAK,UAAA,SAAS,EAAC,uBAAf;AAAA,iCACI,KAAC,MAAD;AAAQ,YAAA,KAAK,EAAEK,IAAf;AAAqB,YAAA,QAAQ,EAAE,kBAACoB,CAAD;AAAA,qBAAOd,UAAU,CAACc,CAAD,CAAjB;AAAA,aAA/B;AAAA,sBAEQf,OAAO,CAACgB,GAAR,CAAY,UAACC,GAAD,EAAMC,CAAN;AAAA,qBACRD,GAAG,CAACD,GAAJ,CAAQ,UAACrB,IAAD;AAAA,oCACJ,KAAC,MAAD;AAA6B,kBAAA,KAAK,EAAEA,IAApC;AAAA,4BAA2CA;AAA3C,kCAAqBA,IAArB,EADI;AAAA,eAAR,CADQ;AAAA,aAAZ;AAFR;AADJ,UADI,gBAaJ;AAAK,UAAA,SAAS,EAAC,uBAAf;AAAA,oBACKK,OAAO,CAACgB,GAAR,CAAY,UAACC,GAAD,EAAMC,CAAN;AAAA,gCACT;AAAK,cAAA,SAAS,EAAC,UAAf;AAAA,sCACI;AAAG,gBAAA,SAAS,oCAA6B,CAAC,IAAD,EAAO,QAAP,EAAiBA,CAAjB,CAA7B,cAAoDD,GAAG,CAACE,OAAJ,CAAYxB,IAAZ,IAAoB,CAAC,CAArB,IAA0B,SAA9E;AAAZ,gBADJ,eAEI,KAAC,KAAD,CAAO,KAAP;AAAa,gBAAA,KAAK,EAAEA,IAApB;AAA0B,gBAAA,QAAQ,EAAE,kBAACyB,CAAD;AAAA,yBAAOnB,UAAU,CAACmB,CAAC,CAACC,MAAF,CAASC,KAAV,CAAjB;AAAA,iBAApC;AAAA,0BACKL,GAAG,CAACD,GAAJ,CAAQ,UAAArB,IAAI;AAAA,sCACT,KAAC,KAAD,CAAO,MAAP;AACc,oBAAA,KAAK,EAAEA,IADrB;AAAA,8BAC4BA;AAD5B,+BAAsBuB,CAAtB,cAA2BvB,IAA3B,EADS;AAAA,iBAAZ;AADL,gBAFJ;AAAA,mCAA4CuB,CAA5C,EADS;AAAA,WAAZ;AADL,UAxBZ,eAuCI,MAAC,MAAD;AACI,UAAA,IAAI,EAAC,SADT;AAEI,UAAA,SAAS,EAAC,WAFd;AAGI,UAAA,OAAO,EAAE;AAAA,mBAAMR,mBAAmB,EAAzB;AAAA,WAHb;AAAA,kCAKI;AAAG,YAAA,SAAS,EAAC;AAAb,YALJ,EAMKpB,QAAQ,GAAG,EAAH,GAAQ,IANrB;AAAA,UAvCJ;AAAA,QAFR,eAmDI;AAAG,QAAA,GAAG,EAAES,QAAR;AAAkB,QAAA,IAAI,yBAAkBP,OAAO,CAACe,OAA1B,cAAqCZ,IAArC,SAAtB;AACG,QAAA,QAAQ,iBAAUH,OAAO,CAACgB,IAAlB,cAA0Bb,IAA1B;AADX,QAnDJ;AAAA;AAPJ,IADJ;AAgEH,CAtHD;;GAAMN,U;;KAAAA,U;AAwHN,eAAeA,UAAf","sourcesContent":["import {useEffect, useState, useRef} from 'react';\r\nimport {Modal, Radio, Spin, Select, Button, message} from 'antd';\r\nimport \"../styles/downDialog.scss\";\r\nimport download from \"../util/download\";\r\nimport axios from \"axios\";\r\nimport throttle from 'lodash/throttle';\r\nconst {Option} = Select;\r\n\r\nconst DownDialog = ({isMobile, visible, imgInfo, onHide,downloadFun}) => {\r\n    const [size, setSize] = useState('1920x1080');\r\n    const [imgLoading, setImgLoading] = useState(true);\r\n    const downLink = useRef();\r\n\r\n    const sizeMap = [\r\n        [\r\n            '1920x1200',\r\n            '1920x1080',\r\n            '1366x768',\r\n            '1280x768',\r\n            '1024x768',\r\n        ],\r\n        [\r\n            '800x600',\r\n            '800x480',\r\n            '768x1280',\r\n            '720x1280',\r\n            '640x480',\r\n            '480x800',\r\n            '400x240',\r\n            '320x240',\r\n            '240x320'\r\n        ]\r\n    ]\r\n\r\n    const updateSize = (val) => {\r\n        window.localStorage.setItem('bing_down_size', val);\r\n        setImgLoading(true);\r\n        setSize(val);\r\n    }\r\n\r\n    const onClickDown = () => {\r\n        const {urlbase, date} = imgInfo;\r\n        download(`//cn.bing.com${urlbase}_${size}.jpg`, `bing_${date}_${size}.jpg`);\r\n        downloadFun(date)\r\n        message.info('加入下载！');\r\n    }\r\n    const throttleOnClickDown = throttle(()=>onClickDown(),3000)\r\n    useEffect(() => {\r\n        let size = window.localStorage.getItem('bing_down_size') || '1920x1080'\r\n        if (isMobile) {\r\n            size = '768x1280';\r\n        }\r\n        setSize(size);\r\n    }, [isMobile])\r\n\r\n    const downImg = useRef();\r\n    useEffect(() => {\r\n        if (downImg && downImg.current && downImg.current.complete) {\r\n            setImgLoading(false);\r\n        }\r\n    }, [imgInfo])\r\n\r\n    return (\r\n        <Modal\r\n            visible={visible}\r\n            onClose={onHide}\r\n            onCancel={onHide}\r\n            footer={null}\r\n            wrapClassName={`down-dialog mode-${isMobile && 'mobile'}`}\r\n        >\r\n            <div className=\"down-dialog-content\">\r\n                {imgInfo && (\r\n                    <div>\r\n                        <Spin spinning={imgLoading}>\r\n                            <img\r\n                                ref={downImg}\r\n                                onLoad={() => setImgLoading(false)}\r\n                                className=\"down-img\"\r\n                                src={`//cn.bing.com${imgInfo.urlbase}_${size}.jpg`}\r\n                            />\r\n                        </Spin>\r\n\r\n                        {\r\n                            isMobile ? (\r\n                                <div className=\"select-size-container\">\r\n                                    <Select value={size} onChange={(v) => updateSize(v)}>\r\n                                        {\r\n                                            sizeMap.map((arr, i) => (\r\n                                                arr.map((size) => (\r\n                                                    <Option key={`size-${size}`} value={size}>{size}</Option>\r\n                                                ))\r\n                                            ))\r\n                                        }\r\n                                    </Select>\r\n                                </div>\r\n                            ) : (\r\n                                <div className=\"select-size-container\">\r\n                                    {sizeMap.map((arr, i) => (\r\n                                        <div className=\"size-row\" key={`size-type-${i}`}>\r\n                                            <i className={`iconfont type-icon icon-${['pc', 'mobile'][i]} ${arr.indexOf(size) > -1 && 'actived'}`}/>\r\n                                            <Radio.Group value={size} onChange={(e) => updateSize(e.target.value)}>\r\n                                                {arr.map(size => (\r\n                                                    <Radio.Button key={`${i}-${size}`}\r\n                                                                  value={size}>{size}</Radio.Button>\r\n                                                ))}\r\n                                            </Radio.Group>\r\n                                        </div>\r\n                                    ))}\r\n                                </div>\r\n                            )\r\n                        }\r\n                        <Button\r\n                            type=\"primary\"\r\n                            className=\"down-icon\"\r\n                            onClick={() => throttleOnClickDown()}\r\n                        >\r\n                            <i className=\"iconfont icon-download\"/>\r\n                            {isMobile ? '' : '下载'}\r\n                        </Button>\r\n                    </div>\r\n                )}\r\n                <a ref={downLink} href={`//cn.bing.com${imgInfo.urlbase}_${size}.jpg`}\r\n                   download={`bing_${imgInfo.date}_${size}.jpg`}/>\r\n            </div>\r\n        </Modal>\r\n    )\r\n}\r\n\r\nexport default DownDialog;\r\n"]},"metadata":{},"sourceType":"module"}