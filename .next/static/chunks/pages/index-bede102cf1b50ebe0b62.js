_N_E=(window.webpackJsonp_N_E=window.webpackJsonp_N_E||[]).push([[12],{RNiq:function(t,e,n){"use strict";n.r(e);var a=n("KQm4"),c=n("nKUr"),o=n("vDqi"),i=n.n(o),s=n("q1tI"),l=(n("Gpft"),n("wd/R")),d=n.n(l),r=(n("2pyn"),n("9+Bb")),u=n("DzJC"),j=n.n(u);e.default=function(){var t=Object(s.useState)(!1),e=t[0],n=t[1],o=Object(s.useState)([]),l=o[0],u=o[1],f=Object(s.useState)({}),b=f[0],m=f[1],h=Object(s.useState)(0),p=h[0],w=h[1],O=Object(s.useState)(!1),v=O[0],g=O[1],N=Object(s.useState)(!1),x=N[0],S=N[1],k=Object(s.useState)(!1),C=k[0],_=k[1],E=Object(s.useState)(!1),y=E[0],D=E[1],M=Object(s.useState)({}),R=M[0],I=M[1],J=Object(s.useState)([]),T=J[0],Y=J[1],q=function(t){var e=window.localStorage.getItem("localLikeList");!T.length&&e&&Y(JSON.parse(e)),t&&((e=e?JSON.parse(e):[]).includes(t)||i()("/api/sort?date=".concat(t,"&k=likeCount")).then((function(n){n.data.likeCount&&(R[t]||(R[t]={likeCount:0}),R[t].likeCount=n.data.likeCount,I(R),e.push(t),Y(e),window.localStorage.setItem("localLikeList",JSON.stringify(e)))})))},H=j()((function(t){return q(t)}),1500);window&&q();var L=function(t,e){g(!0),i()("/api/list?date=".concat(t,"&count=10")).then((function(t){var n=t.data,c=0,o=e?0:2;n.data.forEach((function(t,e){var n=1;c<o&&o&&(n=Math.ceil(2*Math.random())),o-c===10-e&&o&&(n=2),2===n&&(c+=1),t.style={gridColumnStart:"span ".concat(n),gridRowStart:"span ".concat(n)},t.dateStr=d()(t.date,"YYYYMMDD").format("YY.MM.DD"),t.span=n}));var i=n.data.last();u([].concat(Object(a.a)(l),Object(a.a)(n.data))),!i.prev&&D(!0),w(i.prev),g(!1)}))},z=Object(s.useRef)();return Object(s.useEffect)((function(t){window.onscroll=j()((function(){if(!v&&!y){_(document.documentElement.scrollTop>700);var t=document.documentElement.scrollTop,e=document.documentElement.clientHeight,n=Math.ceil(.25*e)+40,a=z.current.clientHeight;t&&e+t+n>a&&L(p,x)}}),100),window.onscroll()}),[p,v]),Object(s.useEffect)((function(){var t=window.innerWidth<1024||window.innerWidth<window.innerHeight?(S(!0),!0):(S(!1),!1);Array.prototype.last=function(){return this[this.length-1]},i()("/api/sort").then((function(t){I(t.data)})),L(p,t)}),[]),Object(c.jsxs)("div",{className:"index-page ".concat(x&&"mobile-page"),ref:z,children:[Object(c.jsx)("div",{className:"img-list",style:{gridTemplateRows:x?"repeat(".concat(l.length,", 75vw)"):"repeat(".concat(4*parseInt(l.length/10),", 19vw)")},children:l.map((function(t){return Object(c.jsxs)("div",{className:"img-item",style:t.style,children:[Object(c.jsxs)("div",{className:"cover",children:[Object(c.jsx)("a",{className:"iconfont icon-fangda actionBtn",href:"/".concat(t.date)}),Object(c.jsx)("span",{className:"text",children:t.cp})]}),Object(c.jsx)("div",{className:"date-str size-".concat(t.span),children:t.dateStr}),Object(c.jsx)("div",{className:"img-bg",style:{backgroundImage:"url('//cn.bing.com".concat(t.urlbase,"_").concat("1024x768",".jpg')")}}),Object(c.jsxs)("div",{className:"handleButton",children:[Object(c.jsx)("span",{className:(T.includes(t.date)?"icon-like-fill":"icon-xihuan")+" iconfont",onClick:function(){H(t.date)},children:Object(c.jsx)("span",{className:"count",children:R[t.date]&&R[t.date].likeCount||0})}),Object(c.jsx)("span",{onClick:function(){n(!0),m(t)},className:"iconfont icon-download",children:Object(c.jsx)("span",{className:"count",children:R[t.date]&&R[t.date].downloadCount||0})})]})]},t.date)}))}),y&&Object(c.jsx)("div",{className:"empty-text",children:"\u2014\u2014 \u5230\u5e95\u5566 \u2014\u2014"}),Object(c.jsxs)("div",{className:"right-btn",children:[Object(c.jsx)("div",{className:"to-top iconfont icon-arrow-left ".concat(!C&&"hide"),onClick:function(){return window.scrollTo(0,0)}}),Object(c.jsx)("a",{className:"iconfont icon-touzi",href:"/random"})]}),Object(c.jsx)(r.a,{downloadFun:function(t){t&&i()("/api/sort?date=".concat(t,"&k=downloadCount")).then((function(e){e.data.likeCount&&(R[t]||(R[t]={downloadCount:0}),R[t].downloadCount=e.data.downloadCount,I(R))}))},isMobile:x,visible:e,onHide:function(){n(!1),m({})},imgInfo:b})]})}},vlRD:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n("RNiq")}])}},[["vlRD",0,2,6,1,5,4]]]);